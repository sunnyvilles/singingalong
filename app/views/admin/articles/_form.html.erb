<div class="articleEdit">
	<style type="text/css">

		.new_article
		{margin-left:25px;}
		.image{
			border: 1px solid black;
		}
	</style>
	<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/flick/jquery-ui.css"></link>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="//tinymce.cachefly.net/4.0/tinymce.min.js"></script>
	<script src="/scripts/tag-it.js"></script>
	<%= form_for([:admin, @article]) do |f| %>

		<% if @article.errors.any? %>
			<div id="error_explanation">
				<h2><%= pluralize(@article.errors.count, "error") %> prohibited this article from being saved:</h2>

				<ul>
					<% @article.errors.full_messages.each do |msg| %>
						<li><%= msg %></li>
					<% end %>
				</ul>
			</div>
		<% end %>

		<div class="field">
			<%= f.label :name %><br />
			<%= f.text_field :name %>
		</div>
		<div class="field">
			<%= f.label :title %><br />
			<%= f.text_field :title %>
		</div>
		<div  class="field source_select">
			<%= f.label :source %><br />
			<%= f.select :source,["clinic", "academy"] %>

		</div>
		<div  class="field type_select">
			<%= f.label :type %><br />
			<%= f.select :type,["article","video", "case study"] %>

		</div>
		<div class="field">
			<%= f.label :content %><br />
			<%= f.text_area :content, :cols => 120, :rows=>30 %>
		</div>

		<%-# image files are being uploaded as file_caption_0 etc , caption texts are going as caption_0 etc -%>
		<div class="image">
			<div class="field">
				<%= f.label :file_caption_0, 'upload a picture' %><br />
				<%= f.file_field :file_caption_0 %>
				<img src="/images/articles/<%=@article[:id]%>-0.jpg" height="50" width="50"></img>
			</div>
			<div class="field">
				<%=f.label :caption_0, 'caption' %>
				<%=f.text_field :caption_0%>
			</div>
		</div>
		<div class="image">
			<div class="field">
				<%= f.label :file_caption_1, 'upload another picture' %><br />
				<%= f.file_field :file_caption_1 %>
				<img src="/images/articles/<%=@article[:id]%>-1.jpg" height="50" width="50"></img>
			</div>
			<div class="field">
				<%=f.label :caption_1, 'caption' %>
				<%=f.text_field :caption_1%>
			</div>
		</div>
		<div class="image">
			<div class="field">
				<%= f.label :file_caption_2, 'upload one more picture' %><br />
				<%= f.file_field :file_caption_2 %>
				<img src="/images/articles/<%=@article[:id]%>-2.jpg" height="50" width="50"></img>
			</div>
			<div class="field">
				<%=f.label :caption_2, 'caption' %>
				<%=f.text_field :caption_2%>
			</div>
		</div>

		<div class="field">
			<%= f.label :youtubeurl, "youtube video url" %><br />
			<%= f.text_field :youtubeurl %>
		</div>

		<div class="field">
			<label>Add Categories:</label>
			<ul id="myTags">
				<%@tags.each{|tag|%>
						<li><%=tag[:title]%></li>
				<%}%>
				
			</ul>
		</div>

		<div class="actions">
			<%= f.submit %>
		</div>
	<% end %>
</div>
<script type="text/javascript">

	tinymce.init({
		selector:'textarea',
		toolbar: " bold italic underline",
		menubar : false
	});
	 $(document).ready(function() {
        $("#myTags").tagit({
					fieldName: "tags[]",
					availableTags: (function(tags){
						var tagArr = [];
						for(var i=0;i<tags.length;i++){
							tagArr.push(tags[i].title)
						}
						console.log(tagArr);
						return tagArr;
					})(<%=raw @all_tags.to_json%>),
					autocomplete: {delay: 0, minLength: 1}
				});
    });

</script>